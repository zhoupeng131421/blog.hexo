---
title: Neutron
date: 2021-4-7
tags: [Neutron]
categories: Learning
---

> Neutron 允许 OpenStack 用户创建和管理网络对象，如网络、子网、端口和路由等，而这些网络对象正是其他 OpenStack 服务正常运行所需的网络资源。

# concept
1. API Server
    - API Server 是 Neutron 的控制器，`用户对网络资源的请求全部先交由 API Server 处理`。API Server 接受到请求后，会调用后端插件进行具体的任务实现。主要实现对L2网络、IP地址管理(IPAM, IP address managment)、L3扩展(L3主要用于对L2网络进行路由，网关用于外网访问)等支持。
    - Neutron包含很多网络插件，主要实现对各种开源虚拟网络支持，对各种商业网络设备和技术的支持，如路由器、物理交换机、虚拟交换机和软件定义网络控制器等。
2. 网络插件和代理
    -  插件与代理的主要功能在于`实现由 API Server 转发的网络资源请求`，如网络端口的插拔、路由增删、络和子网创建以及提供IP地址等。
    - Neutron项目默认自带多个虚拟和物理网络设备插件和代理，如思科的虚拟和物理交换机、NEC的Open flow、Open vSwitch、Linux Bridge、VMware NSX等。
3. Flat网络
    - Neutron 提供两种网络类型，租户网络（Project Network）和供应商网络（Provider Network）。租户网络中每个租户可以创建多个私有网络，租户可自定义私有网络的IP地址范围，不同的租户可以同时使用相同的 IP地址或地址段。与租户网络不同，供应商网络由云管理员创建，并且必须与现有的物理网络匹配。
    - 为了`实现不同租户网络互相隔离`，Neutron 提供了几种不同的网络拓扑与隔离技术，Flat 网络便是其中之一。
    - `在Flat网络中，不同计算节点上的全部实例接人同一个大二层网络内，全部实例共享此网络`，不存在 VLAN 标记或其他网络隔离技术。接人 Flat 网络的全部实例通过数据中心核心路由接人 Internet ，相对于其他的网络类型, Flat网络是最简单的网络类型 。
    -  在 Neutron 的网络实现中，可以同时部署多个隔离的Flat网络，但是每个Flat网络都要独占一个物理网卡。
4. VLAN网络
    - VLAN 网络`允许用户使用外部物理网络中的 VLAN ID 创建多个租户或供应商网络。`
    - VLAN 网络通过 VLAN ID 进行二层网络的隔离，`相同 VLAN ID 内部的实例可以实现自由通信，而不同 VLAN 之间的实例通信则需要经过三层路由的转发`。 由于 VLAN 网络可以实现灵活多样的网络划分与隔离，故 VLAN 网络是生产环境中使用最为普遍的网络。
    - VLAN 网络主要用于私有云环境中，对于大型公有云数据中心，在租户增加的情况下， VLANID 的限制是 VLAN 网络的一大弊端。
5. GRE and VxLan network
    - `GRE 和 VxLAN 是一种网络封装协议`，基于这类封装协议可以`创建重叠（ overlay ）网络以实现和控制不同计算节点实例之间的通信`。 
    -  GRE 和 VxLAN 的 主要区别在于 GRE 网络通过 IP 包进行数据传输，而 VxLAN 通过 UDP 包进行数据传输，GRE 或 VxLAN 数据包在流出节点之前会被打上相应的 GRE 或 VxLAN 网络 ID (Segmentation ID ），而在进入节点后对应的 ID 会被剥离，之后再进入节点内部的虚拟网络进行数据转发。
    - GRE 和 VxLAN 网络中的数据流要进入外部网络，必须配有路由器 ，而且要将租户网络与外部网络互连，路由器也是必备的 。
    -  在 GRE 和 VxLAN 网络中，路由器的主要作用在于通过实例浮动 IP 提供外部网络对实例的直接访问 。
6. Port
    - OpenStack 网络中一种虚拟接口设备，用于模拟物理网络接口。
    - 端口是网络设备连接到某个虚拟网络的接人点，如虚拟机的 NIC 只能通过端口接入虚拟网络，端口还描述了与网络相关的配置，如配置到端口上的 MAC 和 IP 。
7. Subnet
    - Subnet 代表的是一个 IP 段和相关的配置状态。子网 IP 和网络配置信息通常被认为是网络服务为租户网络和供应商网络提供的原生 IPAM 。当某个网络上有新的端口被创建时，网络服务便会使用子网提供的 IP 段为新端口分配 IP 。
8. 子网池
    - 